"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[370],{963:(e,n,a)=>{a.d(n,{A:()=>i});a(6540);var r=a(4164);const t={callout:"callout_jYHE",info:"info_IOty",tip:"tip_s2nh",caution:"caution_w7Js",danger:"danger_zfsw",icon:"icon_Ghiv",content:"content_JMk4"};var o=a(4848);function i({type:e,children:n}){const a=function(e){switch(e){case"info":default:return"\u2139\ufe0f";case"tip":return"\ud83d\udca1";case"caution":return"\u26a0\ufe0f";case"danger":return"\u274c"}}(e),i=(0,r.A)("callout",t.callout,t[e]);return(0,o.jsxs)("div",{className:i,children:[(0,o.jsx)("div",{className:t.icon,children:a}),(0,o.jsx)("div",{className:t.content,children:n})]})}},1724:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>_});const r=JSON.parse('{"id":"module-3-isaac/chapter-15-nav2","title":"Chapter 15 - Nav2","description":"Learning Objectives","source":"@site/docs/module-3-isaac/chapter-15-nav2.mdx","sourceDirName":"module-3-isaac","slug":"/module-3-isaac/chapter-15-nav2","permalink":"/humanoid-robotics/docs/module-3-isaac/chapter-15-nav2","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"Muhammad Uzair","lastUpdatedAt":1765045729000,"sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Chapter 15 - Nav2"},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 14 - Isaac ROS","permalink":"/humanoid-robotics/docs/module-3-isaac/chapter-14-isaac-ros"},"next":{"title":"Chapter 16 - LLMs and Robotics","permalink":"/humanoid-robotics/docs/module-4-vla/chapter-16-llms-and-robotics"}}');var t=a(4848),o=a(8453),i=a(963);const s={sidebar_position:5,title:"Chapter 15 - Nav2"},l="Chapter 15: Navigation 2 (Nav2) with Isaac",c={},_=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Content with Code Examples",id:"content-with-code-examples",level:2},{value:"Mermaid Diagrams",id:"mermaid-diagrams",level:2},{value:"Callouts",id:"callouts",level:2},{value:"Exercises",id:"exercises",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"chapter-15-navigation-2-nav2-with-isaac",children:"Chapter 15: Navigation 2 (Nav2) with Isaac"})}),"\n",(0,t.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,t.jsx)(n.p,{children:"After completing this chapter, you should be able to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Configure Nav2 for simulation and real-world deployment"}),"\n",(0,t.jsx)(n.li,{children:"Integrate Nav2 with Isaac platform for enhanced navigation"}),"\n",(0,t.jsx)(n.li,{children:"Optimize navigation parameters for different environments"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"content-with-code-examples",children:"Content with Code Examples"}),"\n",(0,t.jsx)(n.p,{children:"Navigation 2 (Nav2) is the navigation stack for ROS 2, providing path planning, path execution, and obstacle avoidance capabilities for mobile robots."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'# Example Nav2 configuration file (nav2_params.yaml)\r\namcl:\r\n  ros__parameters:\r\n    use_sim_time: True\r\n    alpha1: 0.2\r\n    alpha2: 0.2\r\n    alpha3: 0.2\r\n    alpha4: 0.2\r\n    alpha5: 0.2\r\n    base_frame_id: "base_footprint"\r\n    beam_skip_distance: 0.5\r\n    beam_skip_error_threshold: 0.9\r\n    beam_skip_threshold: 0.3\r\n    do_beamskip: false\r\n    global_frame_id: "map"\r\n    lambda_short: 0.1\r\n    laser_likelihood_max_dist: 2.0\r\n    max_beams: 60\r\n    max_particles: 2000\r\n    min_particles: 500\r\n    odom_frame_id: "odom"\r\n    pf_err: 0.05\r\n    pf_z: 0.99\r\n    recovery_alpha_fast: 0.0\r\n    recovery_alpha_slow: 0.0\r\n    resolution: 0.05\r\n    robot_model_type: "nav2_amcl::DifferentialMotionModel"\r\n    save_pose_rate: 0.5\r\n    sigma_hit: 0.2\r\n    tf_broadcast: true\r\n    transform_timeout: 1.0\r\n    update_min_a: 0.2\r\n    update_min_d: 0.2\r\n    z_hit: 0.5\r\n    z_max: 0.05\r\n    z_rand: 0.5\r\n    z_short: 0.05\r\n\r\nbt_navigator:\r\n  ros__parameters:\r\n    use_sim_time: True\r\n    global_frame: map\r\n    robot_base_frame: base_link\r\n    odom_topic: /odom\r\n    bt_loop_duration: 10\r\n    default_server_timeout: 20\r\n    # Specify the path where the BT XML files are located\r\n    plugin_lib_names:\r\n    - nav2_compute_path_to_pose_action_bt_node\r\n    - nav2_compute_path_through_poses_action_bt_node\r\n    - nav2_follow_path_action_bt_node\r\n    - nav2_spin_action_bt_node\r\n    - nav2_wait_action_bt_node\r\n    - nav2_back_up_action_bt_node\r\n    - nav2_drive_on_heading_bt_node\r\n    - nav2_clear_costmap_service_bt_node\r\n    - nav2_is_stuck_condition_bt_node\r\n    - nav2_have_remaining_waypoints_condition_bt_node\r\n    - nav2_is_path_valid_condition_bt_node\r\n    - nav2_initial_pose_received_condition_bt_node\r\n    - nav2_reinitialize_global_localization_service_bt_node\r\n    - nav2_rate_controller_bt_node\r\n    - nav2_distance_controller_bt_node\r\n    - nav2_speed_controller_bt_node\r\n    - nav2_truncate_path_action_bt_node\r\n    - nav2_goal_updater_node_bt_node\r\n    - nav2_recovery_node_bt_node\r\n    - nav2_pipeline_sequence_bt_node\r\n    - nav2_round_robin_node_bt_node\r\n    - nav2_transform_available_condition_bt_node\r\n    - nav2_time_expired_condition_bt_node\r\n    - nav2_path_expiring_timer_condition\r\n    - nav2_distance_traveled_condition_bt_node\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# Example Nav2 behavior tree customization for Isaac\r\nimport rclpy\r\nfrom rclpy.action import ActionClient\r\nfrom rclpy.node import Node\r\nfrom nav2_msgs.action import NavigateToPose\r\nfrom geometry_msgs.msg import PoseStamped\r\nfrom std_msgs.msg import String\r\nimport math\r\n\r\nclass IsaacNav2Controller(Node):\r\n    def __init__(self):\r\n        super().__init__(\'isaac_nav2_controller\')\r\n        \r\n        # Create action client for navigation\r\n        self.nav_to_pose_client = ActionClient(\r\n            self, \r\n            NavigateToPose, \r\n            \'navigate_to_pose\'\r\n        )\r\n        \r\n        # Publisher for status\r\n        self.status_pub = self.create_publisher(String, \'nav_status\', 10)\r\n        \r\n        # Timer to send navigation goals\r\n        self.timer = self.create_timer(10.0, self.send_navigation_goal)\r\n        \r\n        # Waypoints to navigate to\r\n        self.waypoints = [\r\n            [2.0, 0.0, 0.0],  # x, y, theta\r\n            [2.0, 2.0, 1.57], \r\n            [0.0, 2.0, 3.14],\r\n            [0.0, 0.0, 0.0]   # Return to start\r\n        ]\r\n        self.current_waypoint = 0\r\n\r\n    def send_navigation_goal(self):\r\n        """Send a navigation goal to Nav2"""\r\n        if not self.nav_to_pose_client.wait_for_server(timeout_sec=1.0):\r\n            self.get_logger().error(\'Navigation action server not available\')\r\n            return\r\n\r\n        goal_msg = NavigateToPose.Goal()\r\n        goal_msg.pose = PoseStamped()\r\n        goal_msg.pose.header.frame_id = \'map\'\r\n        goal_msg.pose.header.stamp = self.get_clock().now().to_msg()\r\n        \r\n        # Set the target pose\r\n        waypoint = self.waypoints[self.current_waypoint]\r\n        goal_msg.pose.pose.position.x = waypoint[0]\r\n        goal_msg.pose.pose.position.y = waypoint[1]\r\n        goal_msg.pose.pose.position.z = 0.0\r\n        \r\n        # Convert theta to quaternion\r\n        theta = waypoint[2]\r\n        goal_msg.pose.pose.orientation.z = math.sin(theta / 2.0)\r\n        goal_msg.pose.pose.orientation.w = math.cos(theta / 2.0)\r\n\r\n        # Send the goal\r\n        self.nav_to_pose_client.send_goal_async(\r\n            goal_msg,\r\n            feedback_callback=self.feedback_callback\r\n        ).add_done_callback(self.goal_response_callback)\r\n        \r\n        self.get_logger().info(f\'Sent navigation goal to waypoint {self.current_waypoint}: {waypoint}\')\r\n        \r\n        # Update waypoint index\r\n        self.current_waypoint = (self.current_waypoint + 1) % len(self.waypoints)\r\n\r\n    def goal_response_callback(self, future):\r\n        """Handle response from navigation server"""\r\n        goal_handle = future.result()\r\n        if not goal_handle.accepted:\r\n            self.get_logger().info(\'Navigation goal rejected\')\r\n            return\r\n\r\n        self.get_logger().info(\'Navigation goal accepted\')\r\n        result_future = goal_handle.get_result_async()\r\n        result_future.add_done_callback(self.get_result_callback)\r\n\r\n    def get_result_callback(self, future):\r\n        """Handle navigation result"""\r\n        result = future.result().result\r\n        self.get_logger().info(f\'Navigation result: {result}\')\r\n\r\n    def feedback_callback(self, feedback_msg):\r\n        """Handle navigation feedback"""\r\n        feedback = feedback_msg.feedback\r\n        # Publish navigation status\r\n        status_msg = String()\r\n        status_msg.data = f\'Navigating: {feedback.current_pose.pose.position.x:.2f}, {feedback.current_pose.pose.position.y:.2f}\'\r\n        self.status_pub.publish(status_msg)\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    controller = IsaacNav2Controller()\r\n    \r\n    try:\r\n        rclpy.spin(controller)\r\n    except KeyboardInterrupt:\r\n        pass\r\n    finally:\r\n        controller.destroy_node()\r\n        rclpy.shutdown()\r\n\r\nif __name__ == \'__main__\':\r\n    main()\n'})}),"\n",(0,t.jsx)(n.h2,{id:"mermaid-diagrams",children:"Mermaid Diagrams"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-mermaid",children:"graph TD;\r\n    A[Nav2 Stack] --\x3e B[Global Planner]\r\n    A --\x3e C[Local Planner]\r\n    A --\x3e D[Controller]\r\n    A --\x3e E[Behavior Tree]\r\n    B --\x3e F[A* / Dijkstra]\r\n    C --\x3e G[TEB / DWA]\r\n    D --\x3e H[PID / MPC]\r\n    E --\x3e I[Recovery Behaviors]\r\n    J[Isaac Perception] --\x3e A\r\n    K[Isaac Mapping] --\x3e A\r\n    L[Sensor Data] --\x3e J\r\n    M[Odometry] --\x3e A\n"})}),"\n",(0,t.jsx)(n.h2,{id:"callouts",children:"Callouts"}),"\n",(0,t.jsx)(i.A,{type:"info",children:(0,t.jsx)(n.p,{children:"Nav2 uses behavior trees to implement complex navigation behaviors, allowing for flexible and robust navigation strategies."})}),"\n",(0,t.jsx)(i.A,{type:"tip",children:(0,t.jsx)(n.p,{children:"When using Nav2 with Isaac, leverage Isaac's sensor simulation and mapping capabilities to create realistic test scenarios."})}),"\n",(0,t.jsx)(i.A,{type:"caution",children:(0,t.jsx)(n.p,{children:"Navigation parameters need to be tuned for specific robots and environments. Start with simulation before applying to real robots."})}),"\n",(0,t.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Configure Nav2 for a robot in Isaac Sim environment"}),"\n",(0,t.jsx)(n.li,{children:"Implement custom behavior tree nodes for specific navigation tasks"}),"\n",(0,t.jsx)(n.li,{children:"Tune navigation parameters for different types of environments"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Nav2 provides comprehensive navigation capabilities for ROS 2"}),"\n",(0,t.jsx)(n.li,{children:"Behavior trees enable complex navigation behaviors"}),"\n",(0,t.jsx)(n.li,{children:"Integration with Isaac enhances simulation and testing"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>i,x:()=>s});var r=a(6540);const t={},o=r.createContext(t);function i(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);